---
title: Address Assertions in RAINS
abbrev: Reverse RAINS
docname: draft-trammell-rains-reverse-latest
date: 
category: exp

ipr: trust200902
keyword: Internet-Draft

stand_alone: yes
pi: [toc, sortrefs, symrefs]

author:
 -
    ins: B. Trammell
    name: Brian Trammell
    organization: ETH Zurich
    street: Universitaetstrasse 6
    city: Zurich
    code: 8092
    country: Switzerland
    email: ietf@trammell.ch
 
# Introduction

\[EDITOR'S NOTE: frontmatter]

# Terminology

\[EDITOR'S NOTE: inherit terminology from rains-protocol]

# Information and Data Model

# Old Content

In contrast to the current domain name system, information about addresses is
stored in a completely separate tree, keyed by address and prefix. An address
assertion consists of the following elements:

- Context: name of the context in which the assertion is valid;
  see {{context-in-address-assertions}}.
- Subject: address about which the assertion is made, consisting of an address
  family, address, and prefix length. A subject may be a network address (where
  the prefix length is less than the address length for the given address
  family) or a host address (where the prefix length is equal to the address
  length for the given address family)
- Type: the type of information about the Subject contained in the assertion.
  Each Assertion is about a single type of data.
- Object: the data of the indicated type associated with the Subject
- Signatures: one or more signatures generated by the authority for the
  Assertion. Signatures contain a time interval during which they are considered
  valid, as in {{signatures}}}}.

The following object types are available:

- Delegation: the authority associated with the subject network address. The
  Object contains a public key by which the authority can be identified. Only
  available for network address subjects.
- Redirection: The name(s) of one or more RAINS servers providing authority
  service for the authority associated with the subject network address. The
  Object contains a set of names. Only available for network address subjects.
- Name: one or more names associated with the subject network address.
  The Object contains a set of names. Only available for host address subjects.
- Zone-Registrant: Information about the organization responsible for a network.
  Only available for network address subjects.

Queries for addresses are similar to those for names, and consist of the following information elements:

- Context: Context in which the query is made; this must match the assertion
  context as in {{context-in-address-assertions}}.
- Subject: the address about which the query is made, consisting of an address
  family, address, and prefix length.
- Types: a set of assertion types the querier is interested in, as above.
- Valid-Until: an optional client-generated timestamp for the query after which
  it expires and should not be answered.
- Query Token: a client-generated token for the query, which can be used
  in the answer to refer to the query.

### Context in Address Assertions

Just as in forward Assertions, Assertion contexts are used in address
assertions to determine the scope of an address assertion, and the signature
chain used to verify it.

- The global addressing context for each address family is identified by the
  special context name '.'. For both IPv4 and IPv6 addresses, this is rooted at
  IANA, which delegates to the RIRs, which then delegates to LIRs and to
  address-holding registries.
- Local contexts associated with a given authority in a forward tree can also
  make assertions about addresses. As with contexts in forward assertions, the
  authority-part and the context-part of a local context name are divided by a
  context marker ('cx--'). The authority-part directly identifies the authority
  whose key was used to sign the address assertion; address assertions within a
  local context are only valid if signed by the identified authority.
  Authorities have complete control over how the contexts under their
  numberspaces are arranged, and over the addresses within those contexts.

Each local context may have a root address space zone (0/0), but these root
address spaces may only delegate addresses that are reserved for local use
{{!RFC1918}} {{!RFC4193}}. Local context assertions for other addresses are
invalid.

## Address Assertion body {#cbor-revassert}

Assertions about addresses are similar to assertions about names, but keyed by
address and restricted in terms of the objects they can contain. An Address
Assertion body is a map which MUST contain the signatures (0), subject-addr (5),
context (6), and objects (7) keys.

The value of the signatures (0) key is an array of one or more Signatures as
defined in {{signatures}}.

The value of the subject-addr (5) key is a three element CBOR array. The first
element of the array is the address family encoded as an object type, 2 for
IPv6 addresses and 3 for IPv4 addresses. The second element is the prefix
length encoded as an integer, 0-128 for IPv6 and 0-32 for IPv4. The third
element is the address, encoded as in {{obj-types}}. Subject addresses with
the maximum prefix length for the address family are subject host addresses,
and are nameable; subject addresses with less than the maximum prefix length
are subject network addresses, and are delegatable.

The value of the context (6) key is a UTF-8 string containing the name of the
context in which the Address Assertion is valid. See
{{context-in-address-assertions}}.

The value of the objects (7) key is an array of objects, as defined in
{{obj-types}}. Only object types redirection, delegation, and registrant are
available for subject network addresses, and only object type name is
available for subject host addresses.

## Address Query body {#cbor-revquery}

Queries for assertions about addresses are similar to queries for assertions
about names, but have semantic restrictions similar to those for Address
Assertions.

An Address Query body is a map. Queries MUST contain the subject-addr (5),
context (6), query-types (10), and query-expires (12) keys. Address Queries MAY
contain query-opts (13) key.

The value of the subject-addr (5) key is a three-element CBOR array. The first
element of the array is the address family encoded as an object type, 2 for
IPv6 addresses and 3 for IPv4 addresses. The second element is the prefix
length encoded as an integer, 0-128 for IPv6 and 0-32 for IPv4. The third
element is the address, encoded as in {{obj-types}}.

The value of the context (6) key is a UTF-8 encoded string containing the name
of the context for which the Query is valid. Unlike queries for names, Address
Queries can only pertain to a single context. See
{{context-in-address-assertions}} for more.

The value of the query-types (10) key is an array of integers encoding the
type(s) of objects (as in {{obj-types}}) acceptable in answers to the query.
All values in the query-type array are treated at equal priority: \[4,5] means
the querier is equally interested in both redirection and delegation for the
subject-addr. An empty query-types array indicates that objects of any type are
acceptable in answers to the query.

The value of the query-expires (12) key is a CBOR integer
counting seconds since the UNIX epoch UTC, identified with tag value 1 and
encoded as in section 2.4.1 of {{!RFC7049}}. After the query-expires time, the
query will have been considered not answered by the original issuer.

The value of the query-opts (13) key, if present, is an array of integers in
priority order of the querier's preferences in tradeoffs in answering the
query, as in {{tabqopts}}. See {{query-opts}} for more.

An Address Assertion with a more-specific prefix is preferred over a
less-specific in response to a Address Query.
