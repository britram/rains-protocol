<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>RAINS (Another Internet Naming Service) Protocol Specification</title>

  <style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc, ul.toc ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Architecture"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Information Model"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Assertion"/>
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Context in Assertions"/>
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 Signatures in Assertions"/>
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 Shards and Zones"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Query"/>
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Context in Queries"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Answer"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Data Model"/>
<link href="#rfc.section.6" rel="Chapter" title="6 RAINS Protocol Definition"/>
<link href="#rfc.section.7" rel="Chapter" title="7 RAINS Client Protocol"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Deployment Considerations"/>
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 On Confidentiality and Integrity Protection"/>
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Authority Signer Interface"/>
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 Client Resolver Interfaces"/>
<link href="#rfc.section.8.4" rel="Chapter" title="8.4 Translation between RAINS and DNS"/>
<link href="#rfc.section.9" rel="Chapter" title="9 Experimental Design and Evaluation"/>
<link href="#rfc.section.10" rel="Chapter" title="10 IANA Considerations"/>
<link href="#rfc.section.11" rel="Chapter" title="11 Security Considerations"/>
<link href="#rfc.section.12" rel="Chapter" title="12 Acknowledgments"/>
<link href="#rfc.references" rel="Chapter" title="13 References"/>
<link href="#rfc.references.1" rel="Chapter" title="13.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="13.2 Informative References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.1 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Trammell, B." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-trammell-rains-protocol" />
  <meta name="dct.issued" scheme="ISO8601" content="2016-8-12" />
  <meta name="dct.abstract" content="This document defines an alternate protocol for Internet name resolution, designed as a prototype to facilitate conversation about the evolution or replacement of the Domain Name System protocol. It attempts to answer the question: &#8220;how would we design the DNS knowing what we do now, with current computing power at our disposal,&#8221; on the background of the properties of an ideal naming service described in " />
  <meta name="description" content="This document defines an alternate protocol for Internet name resolution, designed as a prototype to facilitate conversation about the evolution or replacement of the Domain Name System protocol. It attempts to answer the question: &#8220;how would we design the DNS knowing what we do now, with current computing power at our disposal,&#8221; on the background of the properties of an ideal naming service described in " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">Names and Identifiers Program</td>
  <td class="right">B. Trammell</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">ETH Zurich NetSec</td>
</tr>
<tr>
  <td class="left">Intended status: Experimental</td>
  <td class="right">August 12, 2016</td>
</tr>
<tr>
  <td class="left">Expires: February 13, 2017</td>
  <td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">RAINS (Another Internet Naming Service) Protocol Specification<br />
  <span class="filename">draft-trammell-rains-protocol</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document defines an alternate protocol for Internet name resolution, designed as a prototype to facilitate conversation about the evolution or replacement of the Domain Name System protocol. It attempts to answer the question: &#8220;how would we design the DNS knowing what we do now, with current computing power at our disposal,&#8221; on the background of the properties of an ideal naming service described in <a href="#I-D.trammell-inip-pins">[I-D.trammell-inip-pins]</a>.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on February 13, 2017.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2016 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">Terminology</a></li>
<li>3.   <a href="#rfc.section.3">Architecture</a></li>
<li>4.   <a href="#rfc.section.4">Information Model</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Assertion</a></li>
<ul><li>4.1.1.   <a href="#rfc.section.4.1.1">Context in Assertions</a></li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">Signatures in Assertions</a></li>
<li>4.1.3.   <a href="#rfc.section.4.1.3">Shards and Zones</a></li>
</ul><li>4.2.   <a href="#rfc.section.4.2">Query</a></li>
<ul><li>4.2.1.   <a href="#rfc.section.4.2.1">Context in Queries</a></li>
</ul><li>4.3.   <a href="#rfc.section.4.3">Answer</a></li>
</ul><li>5.   <a href="#rfc.section.5">Data Model</a></li>
<li>6.   <a href="#rfc.section.6">RAINS Protocol Definition</a></li>
<li>7.   <a href="#rfc.section.7">RAINS Client Protocol</a></li>
<li>8.   <a href="#rfc.section.8">Deployment Considerations</a></li>
<ul><li>8.1.   <a href="#rfc.section.8.1">On Confidentiality and Integrity Protection</a></li>
<li>8.2.   <a href="#rfc.section.8.2">Authority Signer Interface</a></li>
<li>8.3.   <a href="#rfc.section.8.3">Client Resolver Interfaces</a></li>
<li>8.4.   <a href="#rfc.section.8.4">Translation between RAINS and DNS</a></li>
</ul><li>9.   <a href="#rfc.section.9">Experimental Design and Evaluation</a></li>
<li>10.   <a href="#rfc.section.10">IANA Considerations</a></li>
<li>11.   <a href="#rfc.section.11">Security Considerations</a></li>
<li>12.   <a href="#rfc.section.12">Acknowledgments</a></li>
<li>13.   <a href="#rfc.references">References</a></li>
<ul><li>13.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>13.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li><a href="#rfc.authors">Author's Address</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a></h1>
<p id="rfc.section.1.p.1">TODO: what is this</p>
<p id="rfc.section.1.p.2">TODO: what is this not</p>
<p id="rfc.section.1.p.3">TODO: why does it exist</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a></h1>
<p id="rfc.section.2.p.1">TODO</p>
<p/>

<ul>
  <li>assertion</li>
  <li>authority</li>
  <li>querier</li>
  <li>context</li>
</ul>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#architecture" id="architecture">Architecture</a></h1>
<p id="rfc.section.3.p.1">The RAINS architecture is simple, and resembles the architecture of DNS. A RAINS Server is an entity that provides transient and/or permanent storage for assertions about names, and a lookup function that finds assertions for a given query about a name, either by searching local storage or by delegating to another RAINS server. RAINS servers can take on any or all of three roles:</p>
<p/>

<ul>
  <li>authority service, acting on behalf of an authority to ensure properly signed assertions are made available to the system (equivalent to an authoritative server in DNS);</li>
  <li>query service, acting on behalf of a client to answer queries with relevant assertions (equivalent to a recursive resolver in DNS), and to validate assertions on the client&#8217;s behalf; and/or</li>
  <li>intermediary service, acting on behalf of neither but providing storage and lookup for assertions with certain properties for query and authority servers (partially replacing, but not really equivalent to, caching resolvers in DNS).</li>
</ul>
<p id="rfc.section.3.p.3">RAINS Servers use the RAINS Protocol defined in this document to exchange queries and assertions. RAINS Clients use a subset variant of the RAINS Protocol (called the RAINS Client Protocol) to interact with RAINS Servers providing query services on their behalf.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#information-model" id="information-model">Information Model</a></h1>
<p id="rfc.section.4.p.1">Messages in the RAINS Protocol are made up of two kinds of elements: Assertion and Query. A third type of element, Answer, binds a Query to a set of Assertions in response to a Query.</p>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#assertion" id="assertion">Assertion</a></h1>
<p id="rfc.section.4.1.p.1">An Assertion is a signed statement about a mapping from a subject name to an object value, and consists of the following elements:</p>
<p/>

<ul>
  <li>Context: name of the context in which the assertion is valid; see <a href="#context-in-assertions">Section 4.1.1</a> below.</li>
  <li>Subject: name about which the assertion is made.</li>
  <li>Zone: name of the zone in which the assertion is made. The fully qualified name of the subject is made by appending the zone name to the subject name with a domain name separator (&#8216;.&#8217;).</li>
  <li>Type: the type of information about the Subject contained in the assertion. Each Assertion is about a single type of data.</li>
  <li>Object: the data of the indicated type associated with the Subject</li>
  <li>Signatures: one or more signatures generated by the authority for the Assertion. Signatures contain a time interval during which they are considered valid, and may contain a revocation token allowing them to be revoked before the end of the time interval. See <a href="#signatures-in-assertions">Section 4.1.2</a> below.</li>
</ul>
<p id="rfc.section.4.1.p.3">The Types supported for each assertion are:</p>
<p/>

<ul>
  <li>Delegation: the authority associated with the zone identified by the name (roughly equivalent to the DNSSEC DS RRTYPE). The Object contains a public key by which the authority can be identified.</li>
  <li>Redirection: The name(s) of one or more a RAINS servers providing authority service for the authority associated with the zone (roughly equivalent to the DNSSEC NS RRTYPE, but not always consulted directly during resolution).  The Object contains a set of names.</li>
  <li>Address: one or more addresses associated with the name (replaces DNS A and AAAA RTYPEs). The Object contains a set of Addresses. An Address is an {address-family, value} tuple.</li>
  <li>Service-Info: one or more layer 4 ports and hostnames associated with a service name (replaces DNS SRV RRTYPE). The object contains a {hostname, port-number, priority tuple}.</li>
  <li>Name: one or more names associated with the name (roughly equivalent to DNS CNAME). The Object contains a set of names.</li>
  <li>Certificate: a certificate which must appear at a specified location in the certificate chain presented on a connection attempt with the named entity (roughly equivalent to DNS TLSA). The details of this type will be described in a separate document.</li>
  <li>Zone-Nameset: an expression of the set of names allowed within a zone; e.g.  Unicode scripts or codepages in which names in the zone may be issued. This allows a zone to set policy on names in support of the distinguishability property in <a href="#I-D.trammell-inip-pins">[I-D.trammell-inip-pins]</a> that can be checked by authority and oracle servers at runtime. An assertion about a Subject within a Zone whose name is not allowed by a valid signed Zone-Nameset expression is taken to be invalid, even if it has a valid signature. The details of this type will be described in a separate document.</li>
</ul>
<p id="rfc.section.4.1.p.5">For a given {subject, type} tuple, multiple assertions can be valid at a given point in time; the union of the object values of all of these assertions is considered to be the set of valid values at that point in time.</p>
<h1 id="rfc.section.4.1.1"><a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#context-in-assertions" id="context-in-assertions">Context in Assertions</a></h1>
<p id="rfc.section.4.1.1.p.1">Assertion contexts are used to determine the validity of the signature by the declared authority as follows:</p>
<p/>

<ul>
  <li>The global context is identified by the special context name `.&#8217;. Assertions in the global context are signed by the authority for the subject name. For example, assertions about the name simplon.inf.ethz.ch in the global context are only valid if signed by the relevant authority inf.ethz.ch.</li>
  <li>A local context is associated with a given authority. The authority-part and the context-part of a local context name are divided by a context marker (&#8216;cx&#8211;&#8217;). The authority-part directly identifies the authority whose key was used to sign the assertion; assertions within a local context are only valid if signed by the identified authority. Authorities have complete control over how the contexts under their namespaces are arranged, and over the names within those contexts.</li>
</ul>
<p id="rfc.section.4.1.1.p.3">Assertion context is the mechanism by which RAINS provides explicit inconsistency (see section 5.3.2 of <a href="#I-D.trammell-inip-pins">[I-D.trammell-inip-pins]</a>). Some examples illustrate how context works:</p>
<p/>

<ul>
  <li>For the common split-DNS case, an enterprise could place names for machines on its local networks within a separate context. E.g., a workstation could be named simplon.cab.inf.ethz.ch within the context staff-workstations.cx&#8211;.inf.ethz.ch. Assertions about this name would be signed by the authority for inf.ethz.ch. Here, the context serves simply as a marker, without enabling an alternate signature chain: note that the name simplon.cab.inf.ethz.ch can be validly signed by the authority for inf.ethz.ch if no delegation exists for cab.inf.ethz.ch. but simply marks this assertion as internal. This allows a client making requests of local names to know they are local, and for local resolvers to manage visibility of assertions outside the enterprise: explicit context makes accidental leakage of both queries and assertions easier to detect and avoid.</li>
  <li>Contexts make captive-portal interactions more explicit: a captive portal resolver could respond to a query for a common website (e.g. www.google.ch) with a signed response directed at the captive portal, but within a context identifying the location as well as the ISP (e.g.  sihlquai.zurich.ch.cx&#8211;.starbucks.access.some-isp.net.). This response will be signed by the authority for starbucks.access.some-isp.net. This signature achieves two things: first, the client knows the result for www.google.ch is not globally valid; second, it can present the user with some indication as to the identity of the captive portal it is connected to.</li>
</ul>
<p id="rfc.section.4.1.1.p.5">Further examples showing how context can be used in queries as well are given in <a href="#context-in-queries">Section 4.2.1</a> below.</p>
<p id="rfc.section.4.1.1.p.6">Developing conventions for assertion contexts for different situations will require implementation and deployment experience, and is a subject for future work.</p>
<h1 id="rfc.section.4.1.2"><a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#signatures-in-assertions" id="signatures-in-assertions">Signatures in Assertions</a></h1>
<p id="rfc.section.4.1.2.p.1">A signature over an assertion contains the following information elements:</p>
<p/>

<ul>
  <li>Algorithm: identifier of the algorithm used to generate the signature.</li>
  <li>Valid-Since: a timestamp of the start of validity of this signature.</li>
  <li>Valid-Until: a timestamp of the end of validity of this signature.</li>
  <li>Signature: the cryptographic signature itself, whose format is determined by the algorithm used.</li>
  <li>Revocation-Token: an optional revocation token for this signature, which allows a signature to be replaced or removed before the end of its validity.  Revocation tokens are generally based on hash chains, meaning that a signature with a revocation token &#8220;down&#8221; the chain from a given token supercedes it. The format and mechanism used by the revocation token is determined by the alogrithm used.</li>
</ul>
<p id="rfc.section.4.1.2.p.3">The signature protects all the information in an assertion as well as its own valid-since and valid-until values; it does not protect the revocation token or other signatures on the assertion.</p>
<h1 id="rfc.section.4.1.3"><a href="#rfc.section.4.1.3">4.1.3.</a> <a href="#shards-and-zones" id="shards-and-zones">Shards and Zones</a></h1>
<p id="rfc.section.4.1.3.p.1">Assertions may also be grouped and signed as a group. A shard is a set of assertions subject to the same authority within the same context, protected by one or more signatures over all assertions within the shard. A shard may have an additional property that given a subject and an authenticated shard, it can be shown that either an assertion with a given name and type exists within the shard or does not exist at all.</p>
<p id="rfc.section.4.1.3.p.2">A shard has the following information elements:</p>
<p/>

<ul>
  <li>Context: name of the context in which the assertions in the shard are valid; see <a href="#context-in-assertions">Section 4.1.1</a> above.</li>
  <li>Zone: name of the zone in which the assertions are made.</li>
  <li>Content: a set of assertions sharing the context and zone.</li>
  <li>Signatures: one or more signatures generated by the authority for the shard; see <a href="#signatures-in-assertions">Section 4.1.2</a>.</li>
  <li>Complete-Flag: if true, the shard is lexicographically complete, and subject names that sort such that they would be within the shard if they existed, but are not in the shard, can be assumed not to exist.</li>
</ul>
<p id="rfc.section.4.1.3.p.4">For efficiency&#8217;s sake, information elements within a shard common to all assertions (zone, context, signature) within the shard may be omitted from the assertions themselves.</p>
<p id="rfc.section.4.1.3.p.5">A zone is the entire set of shards subject to a given authority within a given context. There are three kinds of zones; treating these zones differently may allow lookup protocol optimizations:</p>
<p/>

<ul>
  <li>Zones containing only delegation assertions are delegation-only zones.  Delegation-only zones are not relevant as part of an assertion lookup, other than for discovering and verifying authority. Top-level domains are generally delegation-only.</li>
  <li>Zones containing no delegation assertions are final zones. Final zones are not relevant as part of an authority discovery.</li>
  <li>Zones containing at least one delegation assertion and at least one assertion that is not a delegation assertion are mixed zones. No optimizations are available for mixed zones.</li>
</ul>
<p id="rfc.section.4.1.3.p.7">A zone has the following information elements:</p>
<p/>

<ul>
  <li>Context: name of the context in which the assertions in the zone are valid; see <a href="#context-in-assertions">Section 4.1.1</a> above.</li>
  <li>Zone: name of the zone.</li>
  <li>Content: a set of assertions and/or shards sharing the context and zone.</li>
  <li>Signatures: one or more signatures generated by the authority for the shard; see <a href="#signatures-in-assertions">Section 4.1.2</a>.</li>
  <li>Kind: delegation-only, final, or mixed; see above.</li>
</ul>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#query" id="query">Query</a></h1>
<p id="rfc.section.4.2.p.1">A query is a request for a set of assertions supporting a conclusion about a given subject-object mapping. It consists of the following information elements:</p>
<p/>

<ul>
  <li>Contexts: an expression of the context(s) in which assertions answering the query will be accepted; see <a href="#context-in-queries">Section 4.2.1</a> below.</li>
  <li>Qualified-Subject: the name about which the query is made. The subject name in a query must be fully-qualified.</li>
  <li>Types: a set of assertion types the querier is interested in.</li>
  <li>Valid-Until: an optional client-generated timestamp for the query after which it expires and should not be answered.</li>
  <li>Token: an optional client-generated token for the query, which can be used in the answer to refer to the query (instead of the answer containing the query itself).</li>
</ul>
<p id="rfc.section.4.2.p.3">A query expresses interest about all the given types of assertion in all the specified contexts; more complex expressions of which types in which contexts must be asked using multiple queries.</p>
<p id="rfc.section.4.2.p.4">TODO: provide mechanisms for privacy/performance tradeoffs in queries; are infomodel changes required here?</p>
<h1 id="rfc.section.4.2.1"><a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#context-in-queries" id="context-in-queries">Context in Queries</a></h1>
<p id="rfc.section.4.2.1.p.1">Contexts are used in queries as they are in assertions (see {{context-in- assertions}}). Assertion contexts in an answer to a query have to match some context in the query in order to respond to a query. However, there are a few additional considerations. An assertion can only exist with a specific context, while queries may accept answers in multiple contexts. The Contexts part of a query is a sequence of context specifiers taken to be in order of decreasing priority. A special null context (represented by the empty string) indicates that assertions in any context will be accepted. Any context in the Contexts part of a query may additionally be negated, in order to note that assertions in those contexts are not acceptable. Negated context name appearing in the Contexts part of a query before the null context expresses &#8220;any context except these&#8221;.</p>
<p id="rfc.section.4.2.1.p.2">Query contexts can also be used to provide additional information to RAINS servers about the query. For example, contexts can provide a method for explicit selection of a CDN servers not based on either the client&#8217;s or the resolver&#8217;s address (see <a href="#RFC7871">[RFC7871]</a>). Here, the CDN creates a context for each of its content zones, and an external service selects appropriate contexts for the client based not just on client source address but passive and active measurement of performance. Queries for names at which content resides can then be made within these contexts, with the priority order of the contexts reflecting the goodness of the zone for the client. Here, a context might be zrh.cx&#8211;.cdn-zones.some-cdn.com for names of servers hosting content in a CDN&#8217;s Zurich data center, and a client could represent its desire to find content nearby by making queries in the zrh.cx&#8211;, fra.cx&#8211; (Frankfurt), and ams.cx&#8211; (Amsterdam) contexts within cdn-zones .some-cdn.com. In all cases, the assertions themselves will be signed by the authority for cdn-zones.some-cdn.com, accurately representing that it is the CDN, not the owner of the related name in the global context, that is making the assertion.</p>
<p id="rfc.section.4.2.1.p.3">As with assertion contexts, developing conventions for query contexts for different situations will require implementation and deployment experience, and is a subject for future work.</p>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> <a href="#answer" id="answer">Answer</a></h1>
<p id="rfc.section.4.3.p.1">An answer consists of a set of assertions, shards, and/or zones which respond to a query, bound to that query. It consists of the following information elements:</p>
<p/>

<ul>
  <li>Query: the query this answer applies to. If the query was issued with a token, the query in the answer may omit all content except the token.</li>
  <li>Content: a set of assertions and/or shards answering the query.</li>
</ul>
<p id="rfc.section.4.3.p.3">The content of an answer content depends on whether the answer is positive or negative. A positive answer contains the information requested in the smallest atomic container that can be found, usually a single assertion. A negative answer contains the information used to verify it; either a shard with the Complete-Flag set, an entire Zone, or a Zone-Nameset assertion showing the name is illegal within the zone.</p>
<p id="rfc.section.4.3.p.4">A query is taken to have an inconclusive answer when no answer returns to the querier before the query&#8217;s Valid-Until time.</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#data-model" id="data-model">Data Model</a></h1>
<p id="rfc.section.5.p.1">The RAINS data model is a relatively straightforward mapping of the information model above to the Concise Binary Object Representation (CBOR) <a href="#RFC7049">[RFC7049]</a>, with an outer message type providing a mechanism for future capabilities-based versioning and recognition of a message as a RAINS message.  Each CBOR object in a RAINS message is implemented as a map of integer keys to values, which implements a good tradeoff between efficiency of representation and flexibility.</p>
<p id="rfc.section.5.p.2">TODO: note use the key U+96A8 for versioning in messages.</p>
<p id="rfc.section.5.p.3">TODO: explain why we don&#8217;t use COSE, and what would need to happen for us to be able to.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#rains-protocol-definition" id="rains-protocol-definition">RAINS Protocol Definition</a></h1>
<p id="rfc.section.6.p.1">TODO: note CBOR is self-framing so we can use any transport we want. define TLS 1.3 and TFO for now, note nice fit atop QUIC.</p>
<p id="rfc.section.6.p.2">TODO: note further that signatures are prime in RAINS, so it really doesn&#8217;t matter where servers exist.</p>
<p id="rfc.section.6.p.3">TODO: define an MTI signature algorithm that comes with hashchain revocation.</p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#rains-client-protocol" id="rains-client-protocol">RAINS Client Protocol</a></h1>
<p id="rfc.section.7.p.1">TODO: define as a subset of the full RAINS protocol, plus oracle signatures and tags in answers to allow oracles to verify proof of answer. Preferences for privacy/latency tradeoffs might go here.</p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#deployment-considerations" id="deployment-considerations">Deployment Considerations</a></h1>
<h1 id="rfc.section.8.1"><a href="#rfc.section.8.1">8.1.</a> <a href="#on-confidentiality-and-integrity-protection" id="on-confidentiality-and-integrity-protection">On Confidentiality and Integrity Protection</a></h1>
<p id="rfc.section.8.1.p.1">TODO: note that queries require more confidentiality than assertions. use TLS for hop-by-hop confidentiality for now. point out data confidentiality using COSE as a future next step.</p>
<h1 id="rfc.section.8.2"><a href="#rfc.section.8.2">8.2.</a> <a href="#authority-signer-interface" id="authority-signer-interface">Authority Signer Interface</a></h1>
<p id="rfc.section.8.2.p.1">TODO: need to define a way to keep authority servers from needing secret keys.</p>
<h1 id="rfc.section.8.3"><a href="#rfc.section.8.3">8.3.</a> <a href="#client-resolver-interfaces" id="client-resolver-interfaces">Client Resolver Interfaces</a></h1>
<p id="rfc.section.8.3.p.1">TODO: note we should add RAINS resolver information to DHCP. do we want a multicast address as well? do we need to add context information to DHCP?</p>
<h1 id="rfc.section.8.4"><a href="#rfc.section.8.4">8.4.</a> <a href="#translation-between-rains-and-dns" id="translation-between-rains-and-dns">Translation between RAINS and DNS</a></h1>
<p id="rfc.section.8.4.p.1">TODO: contexts are really hard to wedge into DNS.</p>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> <a href="#experimental-design-and-evaluation" id="experimental-design-and-evaluation">Experimental Design and Evaluation</a></h1>
<p id="rfc.section.9.p.1">TODO: note that this is primarily a prototype for discussion, but that we do intend to implement it. how will we tell if something like RAINS is ready for standardization?</p>
<h1 id="rfc.section.10"><a href="#rfc.section.10">10.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a></h1>
<p id="rfc.section.10.p.1">TODO: tables of CBOR integer keys to meanings in RAINS messages.</p>
<h1 id="rfc.section.11"><a href="#rfc.section.11">11.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a></h1>
<p id="rfc.section.11.p.1">TODO: point at <a href="#signatures-in-assertions">Section 4.1.2</a>, {{on-confidentiality-and- integrity-protection}}, and <a href="#authority-signer-interface">Section 8.2</a>. note that shards for proving non-existence of a name are equivalent to NSEC, and that there is explicitly no resistance against zone enumeration.</p>
<h1 id="rfc.section.12"><a href="#rfc.section.12">12.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a></h1>
<p id="rfc.section.12.p.1">Daniele Asoni, Laurent Chuat, Ted Hardie, Joe Hildebrand, Steve Matsumoto, Adrian Perrig, Raphael Reischuk, Stephen Shirley, Andrew Sullivan, Suzanne Woolf.</p>
<h1 id="rfc.references"><a href="#rfc.references">13.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">13.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="I-D.trammell-inip-pins">[I-D.trammell-inip-pins]</b>
      </td>
      <td class="top"><a>Trammell, B.</a>, "<a href="http://tools.ietf.org/html/draft-trammell-inip-pins-01">Properties of an Ideal Naming Service</a>", Internet-Draft draft-trammell-inip-pins-01, March 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7049">[RFC7049]</b>
      </td>
      <td class="top"><a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="http://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">13.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC1035">[RFC1035]</b>
      </td>
      <td class="top"><a>Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, DOI 10.17487/RFC1035, November 1987.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7871">[RFC7871]</b>
      </td>
      <td class="top"><a>Contavalli, C.</a>, <a>van der Gaast, W.</a>, <a>Lawrence, D.</a> and <a>W. Kumari</a>, "<a href="http://tools.ietf.org/html/rfc7871">Client Subnet in DNS Queries</a>", RFC 7871, DOI 10.17487/RFC7871, May 2016.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Author's Address</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Brian Trammell</span> 
	  <span class="n hidden">
		<span class="family-name">Trammell</span>
	  </span>
	</span>
	<span class="org vcardline">ETH Zurich NetSec</span>
	<span class="adr">
	  <span class="vcardline">Universitaetstrasse 6</span>

	  <span class="vcardline">
		<span class="locality">Zurich</span>,  
		<span class="region"></span>
		<span class="code">8092</span>
	  </span>
	  <span class="country-name vcardline">Switzerland</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ietf@trammell.ch">ietf@trammell.ch</a></span>

  </address>
</div>

</body>
</html>
