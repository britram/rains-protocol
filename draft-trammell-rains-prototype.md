----
title: RAINS, Another Internet Naming Service: Prototype Specification
abbrev: RAINS
docname: draft-trammell-rains-prototype
date: 
category: info

ipr: trust200902
area: Internet Architecture Board
workgroup: Names and Identifiers Program
keyword: Internet-Draft

stand_alone: yes
pi: [toc, sortrefs, symrefs]

author:
 -
    ins: B. Trammell
    name: Brian Trammell
    organization: ETH Zurich, Network Security Group
    street: Universitaetstrasse 6
    city: Zurich
    code: 8092
    country: Switzerland
    email: ietf@trammell.ch

normative:
    draft-trammell-inip-pins:
    RFC7049:

informative:
    RFC1035:

--- abstract

This document describes an alternate protocol for Internet name resolution, designed as a prototype to facilitate conversation about the evolution or replacement of the Domain Name System protocol.

--- middle

# Introduction

# Terminology

- assertion

- authority

- querier

- context

# Architecture

The RAINS architecture is simple, and resembles the architecture of DNS with
fewer restrictions on server roles.

A RAINS Server is an entity that provides transient and/or permanent storage
for assertions about names, and a lookup function that finds assertions for a
given query about a name, either by searching local storage or by delegating
to another RAINS server. RAINS servers can take on any or all of three roles:

- authority service, acting on behalf of an authority to ensure properly signed assertions are made available to the system (equivalent to an authoritative server in DNS);

- query service, acting on behalf of a client to answer queries with relevant assertions (equivalent to a recursive resolver in DNS), and to validate assertions on the client's behalf; and/or

- intermediary service, acting on behalf of neither but providing storage and lookup for assertions with certain properties for query and authority servers (partially replacing, but not really equivalent to, caching resolvers in DNS).

RAINS Servers use the RAINS Protocol defined in this document to exchange
queries and assertions. RAINS clients use a subset of the RAINS Protocol
(called the RAINS Query Protocol) to interact with RAINS Servers providing
query services on their behalf.

# Information Model

Messages in the RAINS Protocol are made up of three kinds of elements: Assertions, Queries, and Notifications. A fourth type of element, binds a Query to a set of Assertions in response to a Query.

## Assertions

An Assertion consists of the following elements:

- Context: name of the context in which the assertion is valid
- Subject: name about which the assertion is made
- Type: the type of information about the Subject contained in the assertion. Each Assertion is about a single type of data.
- Object: the data of the indicated type associated with the Suvject
- Issued: a timestamp at which the assertion was made, and is not valid before
- Expires: a timestamp after which the assertion is no longer valid
- Signature: a signature generated by the authority for the Assertion, covering all elements of the Assertion except the signature itself.

The context name identifies the {\em context} in which the assertion is valid; see {{contexts}} below.

The subject name in an assertion is always fully-qualified (i.e. containing all of the elements of the name back to the root).

The Types supported for each assertion are:

- Delegation: the authority associated with the zone identified by the name (roughly equivalent to the DNSSEC DS RRTYPE). The Object contains a public key by which the authority can be identified.
- Redirection: the address of one or more RAINS servers providing authority service for the authority associated with the zone (roughly equivalent to the DNSSEC NS RRTYPE, but not always consulted directly during resolution). The Object contains a set of Addresses (see below).
- Address: one or more addresses associated with the name (replaces DNS A and AAAA RTYPEs). The Object contains a set of Addresses (see below).
- Name: one or more names associated with the name (roughly equivelant to DNS CNAME). The Object contains a set of names.
- Certificate: a certificate which must appear at a specified location in the certificate chain presented on a connection attempt with the named entity (roughly equivalent to DNS TLSA). 

An Address is...

Since the signature protects the timestamps as well, it is necessary to sign new assertions before old ones expire. At a single point in time, it is possible to have multiple active valid assertions with overlapping validity times for the same subject and type within the same context. 

### Context in Assertions

Assertion contexts are used to determine the validity of the signature by the declared authority as follows:

- The global context is identified by the special context name ``.''. Assertions in the global context are signed by the authority for the subject name. For example, assertions about the name simplon.inf.ethz.ch in the global context are only valid if signed by the relevant authority ethz.ch.
- A local context is associated with a given authority. The authority-part and the context-part of a local context name are divided by a context marker. The authority-part directly identifies the authority whose key was used to sign the assertion; assertions within a local context are only valid if signed by the identified authority. Authorities have complete control over how the contexts under their namespaces are arranged. For example, ethz.ch could create one context for each of its departments, and sign assertions about simplon.local within the inf._ctx_.ethz.ch context.

note: need to define how key exhange works for encrypted contexts in the para below, or cut it:
Assertions in the global context are intended to be publicly available to all
points within the Internet. Resistance to zone enumeration is therefore
explicitly not a design goal of the RAINS protocols. Assertions in contexts
other than the global context may be encrypted with a key known only to
oracles and clients authorized to see information about the context. Enough
information about the context must be left unencrypted in order to determine
an assertion’s inapplicability to a given query.

## Queries

A query is a request for a set of assertions supporting a conclusion about a given subject-object mapping. It consists of the following information elements:

- contexts: a list of context names in which responses will be accepted. A query may also name a special “any” context, signifying a willingness to receive information about names in any context available at the oracle. (actually, need finer-grained context selection than this...)
- subject: the name about which the query is made
- types: a list of the types of information about the subject the query requests.
- token: an optional identifier generated by the querier, which will be echoed back in the response

### Context in Queries

## Answers

(here's a query, and all the assertions we found for it)

(how to authenticate nonexistence? porting nsec3 to rains...)

(other special answers?)

## Notifications

(including error messages)

# Data Model

# Protocol Definition

## RAINS Query Protocol

# IANA Considerations

# Security Considerations

# Acknowledgments


